# Vonage Java SDK Code Snippets
Here are all the snippets in this repository.
This file was generated by running [AggregateSnippets.java](src/main/java/AggregateSnippets.java) from the root of the repository.

## Contents
- [**Initialize**](#initialize)
- [**Account**](#account)
- [**Application**](#application)
- [**Number Insight**](#number-insight)
- [**JWT**](#jwt)
- [**Meetings**](#meetings)
- [**Messages**](#messages)
- [**Fraud Detection**](#fraud-detection)
- [**Numbers**](#numbers)
- [**Redact**](#redact)
- [**SIM Swap**](#sim-swap)
- [**SMS**](#sms)
- [**Subaccounts**](#subaccounts)
- [**Users**](#users)
- [**Verify**](#verify)
- [**Verify v2**](#verify-v2)
- [**Voice**](#voice)
## Initialize
### Application Auth With Key Contents

```java
VonageClient client = VonageClient.builder()
        .applicationId(VONAGE_APPLICATION_ID)
        .privateKeyContents(VONAGE_APPLICATION_PRIVATE_KEY)
        .build();
```
### Full Auth

```java
VonageClient client = VonageClient.builder()
        .apiKey(VONAGE_API_KEY)
        .apiSecret(VONAGE_API_SECRET)
        .applicationId(VONAGE_APPLICATION_ID)
        .privateKeyPath(VONAGE_APPLICATION_PRIVATE_KEY_PATH)
        .build();
```
### Basic Auth

```java
VonageClient client = VonageClient.builder().apiKey(VONAGE_API_KEY).apiSecret(VONAGE_API_SECRET).build();
```
### Application Auth With Key Path

```java
VonageClient client = VonageClient.builder()
        .applicationId(VONAGE_APPLICATION_ID)
        .privateKeyPath(VONAGE_APPLICATION_PRIVATE_KEY_PATH)
        .build();
```
## Account
### Create Secret

```java
SecretResponse response = client.getAccountClient().createSecret(VONAGE_API_KEY, NEW_SECRET);
System.out.println(response.getId() + " created at " + response.getCreated());
```
### Configure Account

```java
SettingsResponse response = client.getAccountClient().updateSmsIncomingUrl(SMS_CALLBACK_URL);
System.out.println("SMS Callback URL is now " + response.getIncomingSmsUrl());
```
### Revoke Secret

```java
client.getAccountClient().revokeSecret(VONAGE_API_KEY, VONAGE_SECRET_ID);
```
### Get Balance

```java
BalanceResponse response = client.getAccountClient().getBalance();
System.out.printf("Balance: %s EUR\n", response.getValue());
System.out.printf("Auto-reload Enabled: %s\n", response.isAutoReload());
```
### Get Secret

```java
SecretResponse response = client.getAccountClient().getSecret(VONAGE_API_KEY, VONAGE_SECRET_ID);
System.out.println(response.getId() + " created at " + response.getCreated());
```
### List Secrets

```java
ListSecretsResponse response = client.getAccountClient().listSecrets(VONAGE_API_KEY);

for (SecretResponse secret : response.getSecrets()) {
    public static void main(String[] args) throws Exception {
        
        String VONAGE_API_KEY = envVar("VONAGE_API_KEY");
        String VONAGE_SIGNATURE_SECRET = envVar("VONAGE_SIGNATURE_SECRET");
        String TO_NUMBER = envVar("TO_NUMBER");
        String VONAGE_BRAND_NAME = envVar("VONAGE_BRAND_NAME");

        VonageClient client = VonageClient.builder()
            .apiKey(VONAGE_API_KEY)
            .signatureSecret(VONAGE_SIGNATURE_SECRET)
            .hashType(HashUtil.HashType.MD5).build();

        TextMessage message = new TextMessage(VONAGE_BRAND_NAME,
                TO_NUMBER,
                "A text message sent using the Vonage SMS API"
        );

        SmsSubmissionResponse response = client.getSmsClient().submitMessage(message);

        if (response.getMessages().get(0).getStatus() == MessageStatus.OK) {
            System.out.println("Message sent successfully.");
        } else {
            System.out.println("Message failed with error: " + response.getMessages().get(0).getErrorText());
        }
```
## Subaccounts
### Transfer Credit

```java
MoneyTransfer receipt = client.getSubaccountsClient().transferCredit(
        MoneyTransfer.builder()
            .from(VONAGE_API_KEY).to(SUBACCOUNT_KEY)
            .amount(AMOUNT).build()
);
System.out.println("Transfer successful: "+receipt.getId());
```
### Transfer Balance

```java
MoneyTransfer receipt = client.getSubaccountsClient().transferBalance(
        MoneyTransfer.builder()
            .from(VONAGE_API_KEY).to(SUBACCOUNT_KEY)
            .amount(AMOUNT).build()
);
System.out.println("Transfer successful: "+receipt.getId());
```
### List Balance Transfers

```java
List<MoneyTransfer> transfers = client.getSubaccountsClient().listBalanceTransfers();
```
### List Subaccounts

```java
ListSubaccountsResponse response = client.getSubaccountsClient().listSubaccounts();
```
### Get Subaccount

```java
Account subaccount = client.getSubaccountsClient().getSubaccount(SUBACCOUNT_KEY);
```
### Deactivate Subaccount

```java
Account subaccount = client.getSubaccountsClient().updateSubaccount(
        UpdateSubaccountRequest.builder(SUBACCOUNT_KEY).suspended(true).build()
);
```
### Rename Subaccount

```java
Account subaccount = client.getSubaccountsClient().updateSubaccount(
        UpdateSubaccountRequest.builder(SUBACCOUNT_KEY)
                .name(NEW_SUBACCOUNT_NAME).build()
);
```
### Create Subaccount

```java
Account subaccount = client.getSubaccountsClient().createSubaccount(
        CreateSubaccountRequest.builder()
            .name(NEW_SUBACCOUNT_NAME)
            .secret(NEW_SUBACCOUNT_SECRET)
            .build()
);
```
### Transfer Number

```java
NumberTransfer transfer = NumberTransfer.builder()
        .from(VONAGE_API_KEY).to(SUBACCOUNT_KEY)
        .number(NUMBER).build();

client.getSubaccountsClient().transferNumber(transfer);
```
### Reactivate Subaccount

```java
Account subaccount = client.getSubaccountsClient().updateSubaccount(
        UpdateSubaccountRequest.builder(SUBACCOUNT_KEY).suspended(false).build()
);
```
### List Credit Transfers

```java
List<MoneyTransfer> transfers = client.getSubaccountsClient().listCreditTransfers();
```
## Users
### Update User

```java
User user = client.getUsersClient().updateUser(
    USER_ID, User.builder()
        .name(USER_NEW_NAME)
        .displayName(USER_NEW_DISPLAY_NAME)
        .build()
);
```
### Get User

```java
User user = client.getUsersClient().getUser(USER_ID);
```
### Delete User

```java
client.getUsersClient().deleteUser(USER_ID);
```
### Create User

```java
User user = client.getUsersClient().createUser(
    User.builder()
        .name(USER_NAME)
        .displayName(USER_DISPLAY_NAME)
        .imageUrl("https://example.com/profile.jpg")
        .channels(
            new Pstn("448001234567"),
            new Sms("447700900000"),
            new Viber("447700900000"),
            new Whatsapp("447700900000"),
            new Viber("447700900000"),
            new Messenger("12345abcd"),
            new Vbc(123),
            new Sip("sip:4442138907@sip.example.com;transport=tls", "myUserName", "P@ssw0rd"),
            new Websocket("wss://example.com/socket")
        )
        .build()
);
```
### List Users

```java
List<BaseUser> users = client.getUsersClient().listUsers();
```
## Verify
### Cancel Verification

```java
ControlResponse response = client.getVerifyClient().cancelVerification(REQUEST_ID);

String errorText = response.getErrorText();
if (errorText != null) {
    System.out.println("Cancellation failed: " + errorText);
}
else {
    System.out.println("Verification cancelled.");
}
```
### Advance Verification

```java
ControlResponse response = client.getVerifyClient().advanceVerification(REQUEST_ID);

String errorText = response.getErrorText();
if (errorText != null) {
    System.out.println("Couldn't advance workflow: " + errorText);
}
else {
    System.out.println("Verification advanced to next stage!");
}
```
### Start Verification With Workflow

```java
VerifyResponse response = client.getVerifyClient().verify(
        RECIPIENT_NUMBER,BRAND_NAME, VerifyRequest.Workflow.TTS_TTS
);

if (response.getStatus() == VerifyStatus.OK) {
    System.out.printf("RequestID: %s", response.getRequestId());
}
else {
    System.out.printf("ERROR! %s: %s", response.getStatus(), response.getErrorText());
}
```
### Search Verification

```java
SearchVerifyResponse response = client.getVerifyClient().search(REQUEST_ID);
if (response.getStatus() == VerifyStatus.OK) {
    response.getVerificationRequests().forEach(it -> {
        System.out.println(it.getRequestId() + " " + it.getStatus());
    });
}
```
### Check Verification

```java
CheckResponse response = client.getVerifyClient().check(REQUEST_ID, CODE);

if (response.getStatus() == VerifyStatus.OK) {
    System.out.println("Verification Successful");
}
else {
    System.out.println("Verification failed: " + response.getErrorText());
}
```
### Start Verification

```java
VerifyResponse response = client.getVerifyClient().verify(RECIPIENT_NUMBER, BRAND_NAME);

if (response.getStatus() == VerifyStatus.OK) {
    System.out.printf("RequestID: %s", response.getRequestId());
}
else {
    System.out.printf("ERROR! %s: %s", response.getStatus(), response.getErrorText());
}
```
### Start PSD2 Verification With Workflow

```java
VerifyResponse response = client.getVerifyClient().psd2Verify(
        RECIPIENT_NUMBER, AMOUNT, PAYEE_NAME, Psd2Request.Workflow.SMS_SMS
);

if (response.getStatus() == VerifyStatus.OK) {
    System.out.printf("Request ID: %s", response.getRequestId());
}
else {
    System.out.printf("Error: %s: %s", response.getStatus(), response.getErrorText());
}
```
### Start PSD2 Verification

```java
VerifyResponse response = client.getVerifyClient().psd2Verify(RECIPIENT_NUMBER, AMOUNT, PAYEE_NAME);

if (response.getStatus() == VerifyStatus.OK) {
    System.out.printf("Request ID: %s", response.getRequestId());
}
else {
    System.out.printf("Error: %s: %s", response.getStatus(), response.getErrorText());
}
```
## Verify v2
### Send Request WhatsApp

```java
VerificationResponse response = client.getVerify2Client().sendVerification(
        VerificationRequest.builder()
            .addWorkflow(new WhatsappWorkflow(TO_NUMBER, WHATSAPP_BUSINESS_NUMBER))
            .brand(BRAND_NAME).build()
);
System.out.println("Verification sent: " + response.getRequestId());
```
### Delete Template

```java
client.getVerify2Client().deleteTemplate(TEMPLATE_ID);
```
### Send Request All Channels

```java
var request = VerificationRequest.builder()
        .workflows(List.of(
                new SilentAuthWorkflow(TO_NUMBER),
                new WhatsappCodelessWorkflow(TO_NUMBER, WHATSAPP_BUSINESS_NUMBER),
                new EmailWorkflow(TO_EMAIL),
                new WhatsappWorkflow(TO_NUMBER, WHATSAPP_BUSINESS_NUMBER),
                new SmsWorkflow(TO_NUMBER),
                new VoiceWorkflow(TO_NUMBER)
        ))
        .codeLength(7)
        .brand(BRAND_NAME)
        .locale("en-gb")
        .channelTimeout(120)
        .build();

var requestId = client.getVerify2Client().sendVerification(request).getRequestId();
System.out.println("Verification sent: "+requestId);
```
### Send Request Email

```java
VerificationResponse response = client.getVerify2Client().sendVerification(
        VerificationRequest.builder()
            .addWorkflow(new EmailWorkflow(TO_EMAIL))
            .brand(BRAND_NAME).build()
);
System.out.println("Verification sent: " + response.getRequestId());
```
### Send Request Voice

```java
VerificationResponse response = client.getVerify2Client().sendVerification(
        VerificationRequest.builder()
                .addWorkflow(new VoiceWorkflow(TO_NUMBER))
                .brand(BRAND_NAME).build()
);
System.out.println("Verification sent: " + response.getRequestId());
```
### Send Request SMS

```java
VerificationResponse response = client.getVerify2Client().sendVerification(
        VerificationRequest.builder()
            .addWorkflow(new SmsWorkflow(TO_NUMBER))
            .brand(BRAND_NAME).build()
);
System.out.println("Verification sent: " + response.getRequestId());
```
### Send Request With Fallback

```java
VerificationResponse response = client.getVerify2Client().sendVerification(
        VerificationRequest.builder()
            .addWorkflow(new SilentAuthWorkflow(TO_NUMBER))
            .addWorkflow(new EmailWorkflow(TO_EMAIL))
            .brand(BRAND_NAME).build()
);
System.out.println("Verification sent: " + response.getRequestId());
```
### Check Verification Code

```java
try {
    client.getVerify2Client().checkVerificationCode(REQUEST_ID, CODE);
    System.out.println("SUCCESS - code matches!");
}
catch (VerifyResponseException ex) {
    switch (ex.getStatusCode()) {
        case 400: // Code does not match
        case 404: // Already verified or not found
        case 409: // Workflow does not support code
        case 410: // Incorrect code provided too many times
        case 429: // Rate limit exceeded
        default:  // Unknown or internal server error (500)
            ex.printStackTrace();
    }
}
```
### Get Template

```java
var template = client.getVerify2Client().getTemplate(TEMPLATE_ID);
System.out.println(template);
```
### List Templates

```java
var templates = client.getVerify2Client().listTemplates();
templates.forEach(t -> System.out.println(t.getId()));
```
### Send Request Silent Auth

```java
VerificationResponse response = client.getVerify2Client().sendVerification(
        VerificationRequest.builder()
            .addWorkflow(new SilentAuthWorkflow(TO_NUMBER))
            .brand(BRAND_NAME).build()
);
System.out.println("Verification sent: " + response.getRequestId());
```
### List Template Fragments

```java
var fragments = client.getVerify2Client().listTemplateFragments(TEMPLATE_ID);
fragments.forEach(f -> System.out.println(f.getFragmentId()));
```
### Create Template

```java
var template = client.getVerify2Client().createTemplate("My_template");
System.out.println(template.getId());
```
### Update Template Fragment

```java
var updated = client.getVerify2Client().updateTemplateFragment(
        TEMPLATE_ID, TEMPLATE_FRAGMENT_ID,
        "The authentication code for your ${brand} is: ${code}"
);
System.out.println(updated);
```
### Create Template Fragment

```java
var fragment = client.getVerify2Client().createTemplateFragment(
        TEMPLATE_ID, new TemplateFragment(
                FragmentChannel.SMS, "en-us",
                "The authentication code for your ${brand} is: ${code}"
        )
);
System.out.println(fragment);
```
### Update Template

```java
var updated = client.getVerify2Client().updateTemplate(TEMPLATE_ID, "My_renamed_template", false);
System.out.println(updated);
```
### Send Request WhatsApp Interactive

```java
VerificationResponse response = client.getVerify2Client().sendVerification(
        VerificationRequest.builder()
            .addWorkflow(new WhatsappCodelessWorkflow(TO_NUMBER, WHATSAPP_BUSINESS_NUMBER))
            .brand(BRAND_NAME).build()
);
System.out.println("Verification sent: " + response.getRequestId());
```
### Cancel Request

```java
client.getVerify2Client().cancelVerification(REQUEST_ID);
```
### Get Template Fragment

```java
var fragment = client.getVerify2Client().getTemplateFragment(TEMPLATE_ID, TEMPLATE_FRAGMENT_ID);
System.out.println(fragment);
```
### Delete Template Fragment

```java
client.getVerify2Client().deleteTemplateFragment(TEMPLATE_ID, TEMPLATE_FRAGMENT_ID);
```
## Voice
### Retrieve Call Info

```java
CallInfo details = client.getVoiceClient().getCallDetails(CALL_UUID);
System.out.println(details);
```
### Record Message

```java
/*
 * Route to answer and connect incoming calls with recording.
 */
Route answerRoute = (req, res) -> {
    String recordingUrl = String.format("%s://%s/webhooks/recordings", req.scheme(), req.host());

    TalkAction intro = TalkAction.builder(
            "Please leave a message after the tone, then press #. We will get back to you as soon as we can.").build();

    RecordAction record = RecordAction.builder()
            .eventUrl(recordingUrl)
            .endOnSilence(3)
            .endOnKey('#')
            .beepStart(true)
            .build();

    TalkAction outro = TalkAction.builder("Thank you for your message. Goodbye").build();

    res.type("application/json");

    return new Ncco(intro, record, outro).toJson();
};

/*
 * Route which prints out the recording URL it is given to stdout.
 */
Route recordingRoute = (req, res) -> {
    EventWebhook recordEvent = EventWebhook.fromJson(req.body());
    System.out.println(recordEvent.getRecordingUrl());

    res.status(204);
    return "";
};

Spark.port(3000);
Spark.get("/webhooks/answer", answerRoute);
Spark.post("/webhooks/recordings", recordingRoute);
```
### Outbound Text To Speech With Event URL

```java
Call call = Call.builder()
        .from(VONAGE_NUMBER).to(new PhoneEndpoint(TO_NUMBER))
        .answerUrl(ANSWER_URL).eventUrl(EVENT_URL).build();

var response = client.getVoiceClient().createCall(call);
System.out.println(response);
```
### Track NCCO Progress

```java
port(3000);

/*
 * Answer Route
 */
get("/webhooks/answer", (req, res) -> {
    String notifyUrl = String.format("%s://%s/webhooks/notification", req.scheme(), req.host());

    TalkAction intro = TalkAction.builder("Thanks for calling the notification line.")
            .build();

    Map<String, String> payload = new HashMap<>();
    payload.put("foo", "bar");

    NotifyAction notify = NotifyAction.builder(payload)
            .eventUrl(notifyUrl)
            .build();

    TalkAction unheard = TalkAction.builder("You will never hear me as the notification URL will return an NCCO")
            .build();

    res.type("application/json");
    return new Ncco(intro, notify, unheard).toJson();
});

/*
 * Notification Route
 */
post("/webhooks/notification", (req, res) -> {
    res.type("application/json");
    return new Ncco(
            TalkAction.builder("Your notification has been received, loud and clear.")
                    .build()
    ).toJson();
});
```
### Transfer Call NCCO

```java
TalkAction talkAction = TalkAction.builder("This is a transfer action using an inline NCCO.").build();
client.getVoiceClient().transferCall(CALL_UUID, new Ncco(talkAction));
```
### Mute Call

```java
client.getVoiceClient().muteCall(CALL_UUID);
Thread.sleep(3000);
client.getVoiceClient().unmuteCall(CALL_UUID);
```
### End Call

```java
client.getVoiceClient().terminateCall(CALL_UUID);
```
### Transfer Call

```java
final String NCCO_URL = "https://nexmo-community.github.io/ncco-examples/talk.json";

client.getVoiceClient().transferCall(CALL_UUID, NCCO_URL);
```
### Record Conversation

```java
final String CONF_NAME = "conf-name";

/*
 * Route to answer and connect incoming calls with recording.
 */
Route answerRoute = (req, res) -> {
    String recordingUrl = String.format("%s://%s/webhooks/recordings", req.scheme(), req.host());

    ConversationAction conversation = ConversationAction.builder(CONF_NAME)
            .record(true)
            .eventMethod(EventMethod.POST)
            .eventUrl(recordingUrl)
            .build();

    res.type("application/json");

    return new Ncco(conversation).toJson();
};

/*
 * Route which prints out the recording URL it is given to stdout.
 */
Route recordingWebhookRoute = (req, res) -> {
    System.out.println(EventWebhook.fromJson(req.body()).getRecordingUrl());

    res.status(204);
    return "";
};

Spark.port(3000);
Spark.get("/webhooks/answer", answerRoute);
Spark.post("/webhooks/recordings", recordingWebhookRoute);
```
### Download Recording

```java
/*
 * A recording webhook endpoint which automatically downloads the specified recording to a file in the
 * current working directory, called "downloaded_recording.mp3"
 */
Route downloadRoute = (req, res) -> {
    EventWebhook event = EventWebhook.fromJson(req.body());
    String recordingUrl = event.getRecordingUrl().toString();
    Path recordingFile = Paths.get("downloaded_recording.mp3");
    System.out.println("Downloading from " + recordingUrl);
    client.getVoiceClient().saveRecording(recordingUrl, recordingFile);
    return "OK";
};

Spark.port(3000);
Spark.post("/recording", downloadRoute);
```
### Earmuff Call

```java
client.getVoiceClient().earmuffCall(CALL_UUID);
Thread.sleep(3000);
client.getVoiceClient().unearmuffCall(CALL_UUID);
```
### Conference Call

```java
final String CONF_NAME = "my-conference";

/*
 * Route to answer incoming calls with an NCCO response.
 */
Route answerRoute = (req, res) -> {
    TalkAction intro = TalkAction.builder("Please wait while we connect you to the conference.").build();
    ConversationAction conversation = ConversationAction.builder(CONF_NAME).build();

    res.type("application/json");

    return new Ncco(intro, conversation).toJson();
};

Spark.port(3000);
Spark.get("/webhooks/answer", answerRoute);
Spark.post("/webhooks/answer", answerRoute);
```
### Record Call

```java
final String TO_NUMBER = envVar("TO_NUMBER");
final String VONAGE_NUMBER = envVar("VONAGE_NUMBER");

/*
 * Route to answer and connect incoming calls with recording.
 */
Route answerRoute = (req, res) -> {
    String recordingUrl = String.format("%s://%s/webhooks/recordings", req.scheme(), req.host());

    RecordAction record = RecordAction.builder().eventUrl(recordingUrl).build();

    ConnectAction connect = ConnectAction.builder(PhoneEndpoint.builder(TO_NUMBER).build())
            .from(VONAGE_NUMBER)
            .build();

    res.type("application/json");

    return new Ncco(record, connect).toJson();
};

/*
 * Route which prints out the recording URL it is given to stdout.
 */
Route recordingRoute = (req, res) -> {
    System.out.println(EventWebhook.fromJson(req.body()).getRecordingUrl());

    res.status(204);
    return "";
};

Spark.port(3000);
Spark.get("/webhooks/answer", answerRoute);
Spark.post("/webhooks/recordings", recordingRoute);
```
### Stream Audio To Call

```java
final String URL = "https://nexmo-community.github.io/ncco-examples/assets/voice_api_audio_streaming.mp3";

var response = client.getVoiceClient().startStream(CALL_UUID, URL, 0);
Thread.sleep(5000);
response = client.getVoiceClient().stopStream(CALL_UUID);
```
### Inbound Call

```java
/*
 * Route to answer incoming call.
 */
Route answerRoute = (req, res) -> {
    String from = req.queryParams("from").replace("", " ");
    TalkAction message = TalkAction
            .builder(String.format("Thank you for calling from %s", from))
            .build();

    res.type("application/json");

    return new Ncco(message).toJson();
};

/*
 * Route to print out call event info.
 */
Route eventRoute = (req, res) -> {
    System.out.println(req.body());
    return "";
};

Spark.port(3000);
Spark.get("/webhooks/answer", answerRoute);
Spark.post("/webhooks/events", eventRoute);
```
### Retrieve Info For All Calls

```java
Date yesterday = new Date(Instant.now().minus(Duration.ofDays(1)).toEpochMilli());
Date now = new Date();

CallsFilter filter = CallsFilter.builder()
        .dateStart(yesterday)
        .dateEnd(now)
        .build();

CallInfoPage calls = client.getVoiceClient().listCalls(filter);
System.out.println(calls.toJson());
```
### Record Call Split Audio

```java
final String TO_NUMBER = envVar("TO_NUMBER");
final String VONAGE_NUMBER = envVar("VONAGE_NUMBER");

/*
 * Route to answer and connect incoming calls with recording.
 */
Route answerRoute = (req, res) -> {
    String recordingUrl = String.format("%s://%s/webhooks/recordings", req.scheme(), req.host());

    RecordAction record = RecordAction.builder()
            .eventUrl(recordingUrl)
            .channels(2)
            .split(SplitRecording.CONVERSATION)
            .build();

    ConnectAction connect = ConnectAction.builder(PhoneEndpoint.builder(TO_NUMBER).build())
            .from(VONAGE_NUMBER)
            .build();

    res.type("application/json");

    return new Ncco(record, connect);
};

/*
 * Route which prints out the recording URL it is given to stdout.
 */
Route recordingRoute = (req, res) -> {
    System.out.println(EventWebhook.fromJson(req.body()).getRecordingUrl());

    res.status(204);
    return "";
};

Spark.port(3000);
Spark.get("/webhooks/answer", answerRoute);
Spark.post("/webhooks/recordings", recordingRoute);
```
### DTMF Input

```java
/*
 * Route to answer incoming calls.
 */
Route answerRoute = (req, res) -> {
    TalkAction intro = TalkAction
            .builder("Hello. Please press any key to continue.")
            .build();

    DtmfSettings dtmfSettings = new DtmfSettings();
    dtmfSettings.setMaxDigits(1);

    InputAction input = InputAction.builder()
            .type(Collections.singletonList("dtmf"))
            .eventUrl(String.format("%s://%s/webhooks/dtmf", req.scheme(), req.host()))
            .dtmf(dtmfSettings)
            .build();


    res.type("application/json");

    return new Ncco(intro, input).toJson();
};

/*
 * Route which returns NCCO saying which DTMF code was received.
 */
Route inputRoute = (req, res) -> {
    EventWebhook event = EventWebhook.fromJson(req.body());

    TalkAction response = TalkAction.builder(String.format("You pressed %s, Goodbye.",
            event.getDtmf().getDigits()
    )).build();

    res.type("application/json");

    return new Ncco(response).toJson();
};

Spark.port(3000);
Spark.get("/webhooks/answer", answerRoute);
Spark.post("/webhooks/dtmf", inputRoute);
```
### Send DTMF To Call

```java
var response = client.getVoiceClient().sendDtmf(CALL_UUID, "332393");
System.out.println(response);
```
### Connect Inbound Call

```java
final String YOUR_SECOND_NUMBER = envVar("YOUR_SECOND_NUMBER");
final String VONAGE_NUMBER = envVar("VONAGE_NUMBER");

/*
 * Route to answer incoming calls with an NCCO response.
 */
Route answerRoute = (req, res) -> {
    ConnectAction connect = ConnectAction.builder()
            .endpoint(PhoneEndpoint.builder(YOUR_SECOND_NUMBER).build())
            .from(VONAGE_NUMBER)
            .build();

    res.type("application/json");

    return new Ncco(connect).toJson();
};

Spark.port(3000);
Spark.get("/webhooks/answer", answerRoute);
Spark.post("/webhooks/answer", answerRoute);
```
### Send Talk To Call

```java
final String TEXT = "Hello World! Would you like to know more? I bet you would.";
var payload = TalkPayload.builder(TEXT).language(TextToSpeechLanguage.AMERICAN_ENGLISH).build();
client.getVoiceClient().startTalk(CALL_UUID, payload);
```
### Outbound Text To Speech

```java
final String VONAGE_NUMBER = envVar("VONAGE_NUMBER");
final String TO_NUMBER = envVar("TO_NUMBER");
final String ANSWER_URL = "https://nexmo-community.github.io/ncco-examples/talk.json";

client.getVoiceClient().createCall(new Call(TO_NUMBER, VONAGE_NUMBER, ANSWER_URL));
```
### ASR Input

```java
/*
 * Route to answer incoming calls.
 */
Route answerCallRoute = (req, res) -> {
    TalkAction intro = TalkAction
            .builder("Please say something")
            .build();

    SpeechSettings speechSettings = SpeechSettings.builder()
            .language(SpeechSettings.Language.ENGLISH_UNITED_STATES).build();

    InputAction input = InputAction.builder()
            .type(Collections.singletonList("speech"))
            .eventUrl(String.format("%s://%s/webhooks/asr", req.scheme(), req.host()))
            .speech(speechSettings)
            .build();


    res.type("application/json");

    return new Ncco(intro, input).toJson();
};

/*
 * Route which returns NCCO saying which word was recognized.
 */
Route speechInputRoute = (req, res) -> {
    EventWebhook event = EventWebhook.fromJson(req.body());

    TalkAction response = TalkAction.builder(String.format("You said %s, Goodbye.",
            event.getSpeech().getResults().get(0).getText()
    )).build();
    res.type("application/json");

    return new Ncco(response).toJson();
};

Spark.port(3000);
Spark.get("/webhooks/answer", answerCallRoute);
Spark.post("/webhooks/asr", speechInputRoute);
```
### Outbound Text To Speech With NCCO

```java
final String VONAGE_NUMBER = envVar("VONAGE_NUMBER");
final String TO_NUMBER = envVar("TO_NUMBER");

Ncco ncco = new Ncco(TalkAction.builder("This is a text to speech call from Vonage").build());

client.getVoiceClient().createCall(new Call(TO_NUMBER, VONAGE_NUMBER, ncco.getActions()));
```
